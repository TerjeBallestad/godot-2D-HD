---
phase: 04-atmosphere
plan: 01
type: execute
wave: 1
depends_on: []
files_modified:
  - scenes/interior/interior_scene.tscn
autonomous: true

must_haves:
  truths:
    - "Bloom/glow creates soft light bleeding on emissive objects only"
    - "Volumetric fog shows visible light shafts from lamps without obscuring scene"
  artifacts:
    - path: "scenes/interior/interior_scene.tscn"
      provides: "Environment with glow and volumetric fog enabled"
      contains: "glow_enabled = true"
  key_links:
    - from: "Environment resource"
      to: "OmniLight3D nodes"
      via: "volumetric fog scatters light from point sources"
      pattern: "volumetric_fog_enabled = true"
---

<objective>
Configure bloom and volumetric fog in the existing WorldEnvironment to create the dreamy HD-2D atmosphere.

Purpose: Bloom adds soft glow around emissive objects (lamps), volumetric fog creates visible light shafts - together they establish the atmospheric foundation for HD-2D style.

Output: Environment resource with glow and volumetric fog settings configured per CONTEXT.md decisions.
</objective>

<execution_context>
@/Users/godstemning/.claude/get-shit-done/workflows/execute-plan.md
@/Users/godstemning/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/phases/04-atmosphere/04-CONTEXT.md
@.planning/phases/04-atmosphere/04-RESEARCH.md
@scenes/interior/interior_scene.tscn
</context>

<tasks>

<task type="auto">
  <name>Task 1: Configure emissive-only bloom in Environment</name>
  <files>scenes/interior/interior_scene.tscn</files>
  <action>
Modify the existing Environment sub_resource (id="Environment_1") in interior_scene.tscn to add bloom/glow settings:

```
glow_enabled = true
glow_intensity = 0.8
glow_strength = 1.0
glow_bloom = 0.0           # CRITICAL: 0 for emissive-only bloom
glow_hdr_threshold = 1.0   # Only HDR values (emission > 1.0) trigger glow
glow_hdr_luminance_cap = 12.0
glow_blend_mode = 0        # Additive
glow_levels/1 = true       # Local glow
glow_levels/2 = true       # Slightly spread
glow_levels/4 = true       # Medium spread
```

Note: The existing lamp OmniLight3D nodes have light_energy < 1.0, so they won't trigger bloom directly. Bloom will work once emissive materials are added to lamp shade meshes (not in scope for this task - existing lamps will show subtle ambient glow from the accumulated light).

Do NOT set glow_bloom > 0 as this makes all bright surfaces glow, losing the emissive-only effect.
  </action>
  <verify>
Open scene in Godot editor. In WorldEnvironment inspector, confirm:
- Glow Enabled is checked
- Glow Bloom is 0.0
- HDR Threshold is 1.0
- Levels 1, 2, 4 are enabled
  </verify>
  <done>Environment has bloom configured for emissive-only glow with warm tint ready for emissive materials.</done>
</task>

<task type="auto">
  <name>Task 2: Configure volumetric fog for light shafts</name>
  <files>scenes/interior/interior_scene.tscn</files>
  <action>
Add volumetric fog settings to the same Environment sub_resource:

```
volumetric_fog_enabled = true
volumetric_fog_density = 0.01           # Very low - barely visible haze
volumetric_fog_albedo = Color(0.9, 0.9, 0.9, 1)  # Neutral gray/white
volumetric_fog_emission = Color(0, 0, 0, 1)
volumetric_fog_emission_energy = 0.0
volumetric_fog_anisotropy = 0.6         # Forward scattering for light shafts
volumetric_fog_length = 64.0
volumetric_fog_detail_spread = 2.0
volumetric_fog_ambient_inject = 0.0
volumetric_fog_gi_inject = 0.0
volumetric_fog_temporal_reprojection_enabled = true
volumetric_fog_temporal_reprojection_amount = 0.9
```

The very low density (0.01) ensures the pixel art remains crisp while allowing light rays from the existing OmniLight3D lamps to become visible in the air.
  </action>
  <verify>
Run scene (F5 in Godot). Look for subtle atmospheric haze and faint light rays from TableLamp and FloorLamp. Scene should NOT look foggy or washed out - the effect should be barely perceptible dust-in-air look.
  </verify>
  <done>Volumetric fog enabled with very light density, creating visible light shafts from lamps without obscuring pixel art clarity.</done>
</task>

</tasks>

<verification>
1. Open interior_scene.tscn in Godot editor
2. Select WorldEnvironment node
3. Verify Environment resource shows both Glow and Volumetric Fog sections expanded with values configured
4. Run scene and orbit camera around lamps - light shafts should be faintly visible
5. Scene should maintain crisp pixel art look (not washed out)
</verification>

<success_criteria>
- Bloom enabled with glow_bloom=0.0 for emissive-only effect
- Volumetric fog enabled with density=0.01 for subtle light shafts
- Scene renders without fog obscuring furniture/character
- REND-02 (bloom) and REND-04 (volumetric fog) requirements addressed
</success_criteria>

<output>
After completion, create `.planning/phases/04-atmosphere/04-01-SUMMARY.md`
</output>
